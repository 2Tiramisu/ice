<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <Target Name="MatlabHome" BeforeTargets="PrepareForBuild">
    <Exec Command="where matlab" ConsoleToMSBuild="true">
      <Output TaskParameter="ConsoleOutput" PropertyName="MatlabExe" />
    </Exec>
    <Error Text="Cannot detect a valid MATALB installation" Condition="!Exists('$(MatlabExe)')"/>
    <CreateProperty Value="$([System.IO.Path]::GetFullPath( '$(MatlabExe)\..\..' ))">
      <Output TaskParameter="Value" PropertyName="MatlabHome" />
    </CreateProperty>
  </Target>
</Project>
